name: Regular badging sequence
description: Publishes a badge based on the job status
inputs:
  category:
    description: The subfolder where to group the badges
    required: true
  badges:
    description: A json object of label => status for all badges
    required: true
  github_token:
    description: The token to use to publish the changes
    required: true
  branch_name:
    description: Name of the branch to publish
    required: true
runs:
  using: composite
  steps:
    - 
      name: Generate json with badges-information
      run: |
        python ./.github/actions/badge/generate_badges.py ${{ inputs.category }} '${{ inputs.badges }}'
      shell: bash
    - 
      name: Push json-files to badges-repo
      uses: peaceiris/actions-gh-pages@v4
      with:
        personal_token: ${{ inputs.github_token }}
        external_repository: kitsudaiki/OpenHanami-badges
        publish_branch: ${{ inputs.branch_name }}
        publish_dir: ./badges
        keep_files: true
        user_name: "github-actions[bot]"
        user_email: "github-actions[bot]@users.noreply.github.com"
